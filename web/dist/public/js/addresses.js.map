{"version":3,"sources":["public/js/addresses.js"],"names":["define","$","ko","mapping","address","self","this","AddressModel","observable","client","_id","recipient","AddressesModel","addresses","swiper","observableAddresses","forEach","push","observableArray","setAddresses","unshift","arguments","id","succeed","success","remove","update","data","status","addressData","console","log","toJS","post","fromJS"],"mappings":"YAAAA,SAAQ,SAAU,WAAY,oBAAqB,SAASC,EAAGC,EAAIC,GAAnEH,EAAOG,QAAAA,CAEHD,IAAGC,GAAUA,SAAbC,GAGI,GAAIC,GAAOC,IADXC,GAAAA,IAAAA,EAAAA,WAAAA,EAAAA,EAAwBH,IAAS,IACjCC,EAAIA,OAAOH,EAAXM,WAAAJ,EAAAA,EAAAK,OAAA,IACAJ,EAAKK,UAASF,EAAAA,WAAWJ,EAAUA,EAAcO,UAAjD,IACAN,EAAKI,QAASP,EAAGM,WAAWJ,EAAUA,EAAQK,QAAhC,IACdJ,EAAKM,MAAAA,EAALH,WAAoBA,EAAWJ,EAAUA,MAAQO,IACjDN,EAAKD,OAALF,EAAeA,WAAAE,EAAcA,EAAUA,OAAV,KAY7BQ,EAAiB,SAASC,EAAWC,GAGjC,QAAIC,GAAAA,GAAJ,GAAIA,KAOJ,OALAF,GAAUG,QAAQ,SAASZ,GAA3BW,EAAAE,KAAA,GAAAV,GAAAH,MAKOW,EAMX,GAAIV,GAAOC,KAOPD,EAAoBQ,EAAAA,EAHxBR,GAAKQ,UAAYX,EAAGgB,gBAAgBH,GAEpCV,EAAKc,aAAe,SAASN,GAQzBR,EAAKQ,UAAUO,EAAAA,KAKfC,EAAAA,WAAA,WAEAhB,EAAIiB,UAAKlB,QAAT,GAAAG,IACAF,EAAKQ,UAGDC,EAAAA,cAAA,SAAAV,GACAmB,UAAAA,IACA,IAAAA,GAAAF,UAAA,GACHC,EAAAlB,EAAAM,KAKGc,OAXJnB,GAAKQ,UAAUY,OAAOrB,GAWlBoB,IAAAA,GACID,EAAAA,aACHA,OAMLT,EAAAA,KAAOY,aAAPJ,GAvBJE,QAAA,SAAAG,EAAAC,GAgBYL,KAYRF,SAAA,OACIE,KAAAA,eAIJT,GAAIe,WAIIC,EAAAA,cAAY,SAAA1B,GACZF,UAAGC,IACHW,IAAAA,GAAOY,UAAP,EAEHI,SACDC,IAPJ,mBAUA,IAAAF,GAAA3B,EAAAC,QAAA6B,KAAA5B,EAAA,OA/ERH,GAAAgC,KAAA,WAAAJ,EAAA,SAAAF,EAAAC,GAuFOhB,QAAPmB,IAAA,mBA5GJ7B,EAAAC,QAAA+B,OAAAP,KAAAvB,GA8FoBU,EAAOY,SACPH,KAEJ,SAGG,GAQf,OAAOX","file":"addresses.js","sourcesContent":["define(['jquery', 'knockout', 'knockout.mapping'], function($, ko, mapping) {\n\n    ko.mapping = mapping;\n\n    var AddressModel = function(address) {\n        var self = this;\n        self._id = ko.observable(address ? address._id : '');\n        self.client = ko.observable(address ? address.client : '');\n        self.recipient = ko.observable(address ? address.recipient : '');\n        self.address = ko.observable(address ? address.address : '');\n        self.phone = ko.observable(address ? address.phone : '');\n        self.isSend = ko.observable(address ? address.isSend : '');\n\n\n        /*this.isChanged = ko.pureComputed(function() {\n\n            return address && address.client == self.client() && address.recipient == self.recipient() && address.address == self.address() && address.phone == self.phone() ? false : true;\n\n        }, this);*/\n    };\n\n    var AddressesModel = function(addresses, swiper) {\n\n        function init(addresses) {\n            var observableAddresses = [];\n\n            addresses.forEach(function(address) {\n\n                observableAddresses.push(new AddressModel(address));\n\n            })\n            return observableAddresses;\n\n        }\n\n\n\n        var self = this;\n\n        var observableAddresses = init(addresses);\n\n        self.addresses = ko.observableArray(observableAddresses);\n\n        self.setAddresses = function(addresses) {\n            self.addresses(init(addresses));\n\n        }\n\n\n        self.addAddress = function() {\n\n            self.addresses.unshift(new AddressModel());\n            swiper.update();\n        };\n\n        self.removeAddress = function(address) {\n            arguments[3]();\n            var succeed = arguments[4];\n            var id = address._id();\n            self.addresses.remove(address);\n\n            if (id == '') {\n                swiper.update();\n                succeed();\n                return;\n            }\n\n\n\n            $.ajax('./address/' + id, {\n                success: function(data, status) {\n                    succeed();\n                },\n                dataType: 'json',\n                type: 'DELETE'\n\n            });\n\n            swiper.update();\n\n        };\n\n        self.submitAddress = function(address) {\n            arguments[3]();\n            var succeed = arguments[4];\n\n            console.log('post request....');\n\n            var addressData = ko.mapping.toJS(address); //$.parseJSON(ko.toJSON(address));\n\n            $.post('/address', addressData, function(data, status) {\n\n                    console.log('get post result');\n                    ko.mapping.fromJS(data, {}, address);\n                    swiper.update();\n                    succeed();\n                },\n                'json'\n            );\n\n            return false;\n\n        };\n    };\n\n\n\n\n    return AddressesModel;\n\n})\n"]}