{"version":3,"sources":["public/js/main.js"],"names":["requirejs","config","baseUrl","paths","knockout","knockout.mapping","ReceivedOrders","ReckoningOrders","IncomeList","Addresses","ItemsModel","swiper","colorbox","tag","angular","ngResource","ngAnimate","settings.component","shim","exports","deps","require","OrdersModel","ko","$","Swiper","setTimeout","getJSON","orders","status","ordersModel","setOrders","update","activeIndex","observableOrders","reckoningOrdersModel","getObservableOrders","updateAllData","rs","itemsModel","resolve","promise","tags","item","find","incomeListModel","setIncomeList","isTouch","document","documentElement","on","fn","_on","arguments","apply","bindingHandlers","tap","init","element","valueAccessor","allBindings","viewModel","bindingContext","handler","event","$target","target","$submitting","$succeed","hasClass","offset","one","$confirm","fadeOut","$data","$parent","children","top","show","addClass","removeClass","delay","activeElement","text","needRefreshCurrent","needRefreshRest","css","paginationBulletRender","bulletName","autoHeight","spaceBetween","pagination","paginationClickable","simulateTouch","longSwipes","className","applyBindings","index","updateCurrentData","IncomeListModel","AddressesModel","purchasePromise","Promise","reject","items","oldTag","res","USER_ID","catch","reason","then","Array","isArray","newTag","reckoningPromise","allItems","length","_id","itemName","forEach","indexOf","push","trigger","all","incomeList","inline","keyCode","height","blur","close","targetPage","onComplete","setInterval","window","scrollTop","bootstrap","width","scrolling","resize","scroll"],"mappings":"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","file":"main.js","sourcesContent":["requirejs.config({\n\n    baseUrl: './components',\n\n    paths: {\n\n        'jquery': './jquery/dist/jquery.min',\n        'knockout': './knockout/dist/knockout',\n        'knockout.mapping': '../js/knockout.mapping.2.4.1.min',\n        'ReceivedOrders': '../js/received-orders',\n        'ReckoningOrders': '../js/reckoning-orders',\n        'IncomeList': '../js/income-list',\n        'Addresses': '../js/addresses',\n        'ItemsModel': '../js/purchase-items',\n        'swiper': './swiper/dist/js/swiper.jquery.min',\n        'colorbox': './jquery-colorbox/jquery.colorbox-min',\n        'tag': '../js/jquery.tag',\n        'angular': './angular/angular.min',\n        'ngResource': './angular-resource/angular-resource.min',\n        'ngAnimate': './angular-animate/angular-animate.min',\n       // 'settings.module': '../js/settings/settings.module',\n        //'settings.component': '../js/settings/settings.component'\n        'settings.component': '../js/settings/settings.min'\n    },\n    shim: {\n        'swiper': ['jquery'],\n        'knockout.mapping': ['knockout'],\n        'colorbox': ['jquery'],\n        'tag': ['jquery'],\n\n        'angular': {\n            exports: 'angular'\n        },\n        'ngResource': {\n            deps: ['angular'],\n            exports: 'angular'\n        },\n        'ngAnimate': {\n            deps: ['angular'],\n            exports: 'angular'\n        },\n    }\n\n});\n\n\nrequire(['ReceivedOrders', 'knockout', 'jquery', 'swiper'], function(OrdersModel, ko, $, Swiper) {\n\n    var isTouch = ('ontouchstart' in document.documentElement) ? 'touchstart' : 'click';\n    var _on = $.fn.on;\n    $.fn.on = function() {\n        arguments[0] = (arguments[0] === 'click') ? isTouch : arguments[0];\n        return _on.apply(this, arguments);\n    }\n\n    ko.bindingHandlers.tap = {\n\n        init: function(element, valueAccessor, allBindings, viewModel, bindingContext) {\n\n            var handler = valueAccessor();\n\n            $(element).on('click', function(event) {\n\n                var $target = $(event.target);\n                var $submitting = $('.prompt-submitting');\n                var $succeed = $('.prompt-succeed');\n                var $confirm = $('.confirm');\n\n                if ($target.hasClass('action-delete') && $target.hasClass('action-submit')) {\n                    var offset = $target.offset();\n\n                    $('.confirm-submit').one('click', function() {\n\n                        $confirm.fadeOut('slow');\n                        handler(bindingContext.$data, bindingContext.$parent, event, function() {\n                            $submitting.children('span').text(\"提交中...\");\n                            var offset = $target.offset();\n                            $('.prompt').css('top', offset.top).show();\n\n                        }, function() {\n\n                            $submitting.addClass('disappeared')\n                            $succeed.removeClass('disappeared')\n\n                            $('.prompt').delay(600).fadeOut('slow', function() {\n                                $submitting.removeClass('disappeared')\n                                $succeed.addClass('disappeared')\n                            });\n\n                            updateAllData();\n\n                        });\n\n                    })\n\n                    $('.confirm-cancel').one('click', function() {\n\n                        $confirm.fadeOut('slow');\n\n                    })\n\n                    $('.confirm').css('top', offset.top).fadeIn('slow');\n\n\n                } else if ($target.hasClass('action-submit')) {\n\n                    var activeElement = $(document.activeElement);\n\n                    if (!activeElement.hasClass('action-submit')) {\n                        activeElement.blur();\n\n                    }\n\n                    setTimeout(function() {\n\n                        handler(bindingContext.$data, bindingContext.$parent, event, function() {\n                            $submitting.children('span').text(\"提交中...\");\n                            var offset = $target.offset();\n                            $('.prompt').css('top', offset.top).show();\n\n                        }, function(needRefreshRest, needRefreshCurrent) {\n\n                            $submitting.addClass('disappeared')\n                            $succeed.removeClass('disappeared')\n\n\n                            $('.prompt').delay(1200).fadeOut('slow', function() {\n                                $submitting.removeClass('disappeared')\n                                $succeed.addClass('disappeared')\n\n                            });\n\n\n                            if (needRefreshCurrent) {\n                                updateCurrentData();\n                            }\n\n                            if (needRefreshRest) {\n                                updateAllData();\n                            }\n\n\n                        });\n\n\n\n                    }, 100);\n\n\n\n                } else if ($target.hasClass('action-load')) {\n\n                    handler(bindingContext.$data, bindingContext.$parent, event, function() {\n                        $submitting.children('span').text(\"加载中...\");\n                        var offset = $target.offset();\n                        $('.prompt').css('top', offset.top).show();\n\n                    }, function() {\n\n                        $('.prompt').delay(600).fadeOut('slow');\n                        swiper.update();\n\n                    });\n\n                } else {\n                    handler(bindingContext.$data, bindingContext.$parent, event);\n\n\n                }\n                return false;\n            });\n\n\n        },\n        update: function(element, valueAccessor, allBindings, viewModel, bindingContext) {\n\n        }\n    }\n\n\n\n    var swiper = new Swiper('.swiper-container', {\n        autoHeight: true,\n        spaceBetween: 30,\n        pagination: '.swiper-pagination',\n        paginationClickable: true,\n        simulateTouch: false,\n        shortSwipes: false,\n        longSwipes: false,\n        paginationBulletRender: function(index, className) {\n            var bulletName = '';\n            switch (index) {\n                case 0:\n\n                    bulletName = '接单';\n                    break;\n\n                case 1:\n                    bulletName = '采购';\n                    break;\n\n                case 2:\n                    bulletName = '算账';\n                    break;\n\n                case 3:\n                    bulletName = '收益';\n                    break;\n                    /* case 4:\n                         bulletName = 'Delivery';\n                         break;*/\n            }\n            return '<span class=\"' + className + '\">' + bulletName + '</span>';\n        }\n\n    });\n    var itemsModel, reckoningOrdersModel, incomeListModel, addressesModel;\n\n    var ordersModel = new OrdersModel(orders);\n\n    ko.applyBindings(ordersModel, $('#receivedOrders')[0]);\n\n    ordersModel.setSwiper(swiper);\n\n\n    function updateCurrentData() {\n\n        if (swiper.activeIndex == 0) {\n\n            $.getJSON('./receivedOrdersJson', function(orders, status) {\n                ordersModel.setOrders(orders);\n                setTimeout(function() {\n                    swiper.update();\n                }, 100);\n            });\n\n        }\n\n        if (swiper.activeIndex == 2) {\n\n            $.getJSON('./reckoningOrdersJson', function(orders, status) {\n\n                var observableOrders = reckoningOrdersModel.getObservableOrders(orders);\n                reckoningOrdersModel.orders(observableOrders);\n                setTimeout(function() {\n                    swiper.update();\n                }, 100);\n\n            })\n\n        }\n\n    }\n\n    function updateAllData() {\n\n        var activeIndex=swiper.activeIndex ;\n\n\n        if (activeIndex == 1 || activeIndex==2) {\n            $.getJSON('./receivedOrdersJson', function(orders, status) {\n                ordersModel.setOrders(orders);\n                setTimeout(function() {\n                    swiper.update();\n                }, 100);\n            });\n\n        }\n\n        if (activeIndex == 0 || activeIndex == 2) {\n\n            $.getJSON('./purchaseItemsJson', function(rs, status) {\n                itemsModel.setItems(rs.items, true);\n                setTimeout(function() {\n                    swiper.update();\n                }, 100);\n            });\n\n        }\n\n\n        if (activeIndex == 0 || activeIndex==1) {\n\n            $.getJSON('./reckoningOrdersJson', function(orders, status) {\n\n                var observableOrders = reckoningOrdersModel.getObservableOrders(orders);\n                reckoningOrdersModel.orders(observableOrders);\n                setTimeout(function() {\n                    swiper.update();\n                }, 100);\n\n            })\n\n        }\n\n        if (activeIndex ==2) {\n\n            $.getJSON('./incomeListJson', function(incomeList, status) {\n                incomeListModel.setIncomeList(incomeList);\n            })\n            setTimeout(function() {\n                swiper.update();\n            }, 100);\n\n        }\n    }\n\n\n    require(['ItemsModel', 'ReckoningOrders', 'IncomeList', 'Addresses', 'knockout', 'jquery', 'tag'], function(ItemsModel, OrdersModel, IncomeListModel, AddressesModel, ko, $) {\n\n\n        var purchasePromise = new Promise(function(resolve, reject) {\n\n            $.getJSON('./purchaseItemsJson', function(rs, status) {\n\n                itemsModel = new ItemsModel(rs.items, swiper);\n\n                resolve(itemsModel);\n\n\n                ko.applyBindings(itemsModel, $('#purchaseItems')[0]);\n\n\n                var promise = new Promise(function(resolve, reject) {\n                    $.getJSON(`./user/${USER_ID}`, function(rs, status) {\n                        resolve(rs);\n                    });\n                });\n\n                promise.catch(function(reason) {\n\n                })\n\n                promise.then(function(rs) {\n\n                    var tags = Array.isArray(rs.tags) ? rs.tags : [];\n\n                    $('.hidden-tag').tag({\n                        tags: tags,\n                        updateTag: function(itemName, oldTag, newTag) {\n\n                            if(oldTag==newTag)return;\n\n                            if (Array.isArray(itemsModel.allItems) && itemsModel.allItems.length > 0) {\n                                var item = itemsModel.allItems.find(function(item) {\n                                    return item._id == itemName;\n\n                                });\n\n                                item.tag = newTag;\n\n                                if (item) {\n\n                                    var tags = [];\n\n\n                                    itemsModel.allItems.forEach(function(item) {\n\n                                        if (tags.indexOf(item.tag) < 0 && item.tag) {\n                                            tags.push(item.tag);\n                                        }\n\n                                    })\n\n                                    itemsModel.tags(tags);\n                                }\n\n                            }\n\n                            $.post('./itemtag', {\n                                    itemName: itemName,\n                                    oldTag: oldTag,\n                                    newTag: newTag\n\n                                }, function(res, status) {\n\n                                    updateAllData();\n\n                                },\n                                'json'\n                            );\n\n                        }\n\n                    });\n\n                });\n\n            });\n\n        });\n\n        var reckoningPromise = new Promise(function(resolve, reject) {\n\n            $.getJSON('./reckoningOrdersJson', function(orders, status) {\n                reckoningOrdersModel = new OrdersModel(orders, swiper);\n                resolve(reckoningOrdersModel);\n                ko.applyBindings(reckoningOrdersModel, $('#reckoningOrders')[0]);\n\n            });\n\n        })\n\n        Promise.all([purchasePromise,reckoningPromise]).then(function(rs){\n            rs[0].ordersModel = ordersModel;\n            rs[0].reckoningOrdersModel=rs[1];\n\n        })\n\n\n\n\n\n\n        $.getJSON('./incomeListJson', function(incomeList, status) {\n            incomeListModel = new IncomeListModel(incomeList, swiper);\n            ko.applyBindings(incomeListModel, $('#incomeList')[0]);\n\n\n        });\n\n        // $.getJSON('./addressesJson', function(addresses, status) {\n        //     addressesModel = new AddressesModel(addresses, swiper);\n        //     ko.applyBindings(addressesModel, $('#addresses')[0]);\n\n        // });\n\n\n\n        $(document).on('keydown', function(event) {\n            if (event.keyCode == 13 && (swiper.activeIndex == 0 || swiper.activeIndex == 2)) {\n                //var $target = $(document.activeElement).closest('.enterArea').find('.action-enter');\n                $(document.activeElement).blur();\n\n                var targetPage = swiper.activeIndex == 0 ? 'receivedOrders' : 'reckoningOrders'\n\n                var $target = $('#' + targetPage + ' .action-enter');\n                setTimeout(function() {\n                    $target.trigger('click')\n                }, 100);\n                return false;\n\n            }\n\n        });\n\n\n        swiper.params.onSlideChangeStart = function(swiper) {\n\n            // switch (swiper.activeIndex) {\n            //     case 0:\n            //         $.getJSON('./receivedOrdersJson', function(orders, status) {\n\n            //             ordersModel.setOrders(orders);\n            //             swiper.update();\n\n            //         });\n            //         break;\n            //     case 1:\n            //         $.getJSON('./purchaseItemsJson', function(rs, status) {\n            //             itemsModel.setItems(rs.items, rs.markedItems);\n            //             swiper.update();\n\n            //         });\n            //         break;\n\n            //     case 2:\n            //         $.getJSON('./reckoningOrdersJson', function(orders, status) {\n\n            //             var observableOrders = reckoningOrdersModel.getObservableOrders(orders);\n            //             reckoningOrdersModel.orders(observableOrders);\n            //             swiper.update();\n\n            //         })\n            //         break;\n            //     case 3:\n            //         $.getJSON('./incomeListJson', function(incomeList, status) {\n            //             incomeListModel.setIncomeList(incomeList);\n            //             swiper.update();\n\n            //         })\n            //         break;\n            //     case 4:\n            //         $.getJSON('./addressesJson', function(addresses, status) {\n            //             addressesModel.setAddresses(addresses);\n            //             swiper.update();\n\n            //         })\n            //         break;\n            // }\n\n            setTimeout(function() {\n                $(window).scrollTop(0);\n            }, 100);\n\n\n        }\n\n\n    });\n\n\n    require(['jquery', 'angular', 'settings.component', 'colorbox'], function($, angular) {\n\n        angular.bootstrap($('#settings')[0], ['settings']);\n\n        $('.icon-cog').colorbox({\n            inline: true,\n            width: 335,\n            height: 200,\n            scrolling: false,\n            close: '',\n            top: 0,\n            onComplete: function() {\n                setInterval(function() {\n\n                    /*                    var iframe = $('.cboxIframe')[0];\n\n                                        if (iframe) {\n                                            var doc = iframe.contentDocument || iframe.document;\n\n                                            var height = Math.max(doc.body ? doc.body.clientHeight : 0, doc.documentElement.scrollHeight);\n\n                                            height = height < 200 ? 200 : height;\n\n                                            $.colorbox.resize({ height: height });\n                                        }*/\n\n                    $.colorbox.resize();\n\n\n                }, 200)\n            }\n        });\n\n        $(window).scroll(function() {\n            var top = $(window).scrollTop();\n            $(\".cogbox\").css(\"top\", top + 10);\n            $(\".swiper-pagination\").css('top', top);\n            $(\".searchbox\").css(\"top\", top);\n\n        });\n\n    })\n\n\n});\n"]}