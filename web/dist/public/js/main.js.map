{"version":3,"sources":["public/js/main.js"],"names":["requirejs","config","baseUrl","jquery","paths","ReceivedOrders","ReckoningOrders","IncomeList","Addresses","ItemsModel","swiper","shim","knockout.mapping","require","OrdersModel","ko","$","Swiper","isTouch","document","documentElement","_on","fn","on","arguments","apply","this","bindingHandlers","tap","init","element","valueAccessor","allBindings","viewModel","handler","event","$target","target","$submitting","$succeed","$confirm","hasClass","offset","one","fadeOut","bindingContext","$data","$parent","children","text","css","top","show","removeClass","addClass","fadeIn","setTimeout","delay","ordersModel","orders","paginationClickable","bulletName","update","autoHeight","spaceBetween","pagination","simulateTouch","shortSwipes","longSwipes","paginationBulletRender","index","className","setSwiper","scroll","itemsModel","getJSON","incomeList","window","scrollTop","activeElement","IncomeListModel","AddressesModel","targetPage","activeIndex","addressesModel","rs","status","trigger","items","markedItems","applyBindings","params","reckoningOrdersModel","setOrders","incomeListModel","keyCode","onSlideChangeStart","setItems","observableOrders","getObservableOrders","setIncomeList","addresses","setAddresses"],"mappings":"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","file":"main.js","sourcesContent":["requirejs.config({\n\n    baseUrl: './components',\n\n    paths: {\n        jquery: 'jquery/dist/jquery.min',\n        'knockout': 'knockout/dist/knockout',\n        'knockout.mapping': '/js/knockout.mapping.2.4.1.min',\n        'ReceivedOrders': '/js/received-orders',\n        'ReckoningOrders': '/js/reckoning-orders',\n        'IncomeList': '/js/income-list',\n        'Addresses': '/js/addresses',\n        'ItemsModel':'/js/purchase-items',\n        'swiper': 'swiper/dist/js/swiper.jquery.min'\n\n\n    },\n    shim: {\n        'swiper': ['jquery'],\n        'knockout.mapping':['knockout']\n    }\n\n});\n\n\nrequire(['ReceivedOrders', 'knockout', 'jquery', 'swiper'], function(OrdersModel, ko, $, Swiper) {\n\n    var isTouch = ('ontouchstart' in document.documentElement) ? 'touchstart' : 'click';\n    var _on = $.fn.on;\n    $.fn.on = function() {\n        arguments[0] = (arguments[0] === 'click') ? isTouch : arguments[0];\n        return _on.apply(this, arguments);\n    }\n\n    ko.bindingHandlers.tap = {\n\n        init: function(element, valueAccessor, allBindings, viewModel, bindingContext) {\n\n            var handler = valueAccessor();\n\n            $(element).on('click', function(event) {\n\n                var $target = $(event.target);\n                var $submitting = $('.prompt-submitting');\n                var $succeed = $('.prompt-succeed');\n                var $confirm = $('.confirm');\n\n                if ($target.hasClass('action-delete') && $target.hasClass('action-submit')) {\n                    var offset = $target.offset();\n\n                    $('.confirm-submit').one('click', function() {\n\n                        $confirm.fadeOut('slow');\n                        handler(bindingContext.$data, bindingContext.$parent, event, function() {\n                            $submitting.children('span').text(\"Submitting...\");\n                            var offset = $target.offset();\n                            $('.prompt').css('top', offset.top).show();\n\n                        }, function() {\n\n                            $submitting.addClass('disappeared')\n                            $succeed.removeClass('disappeared')\n\n                            $('.prompt').delay(600).fadeOut('slow', function() {\n                                $submitting.removeClass('disappeared')\n                                $succeed.addClass('disappeared')\n                            });\n\n                        });\n\n                    })\n\n                    $('.confirm-cancel').one('click', function() {\n\n                        $confirm.fadeOut('slow');\n\n                    })\n\n                    $('.confirm').css('top', offset.top).fadeIn('slow');\n\n\n                } else if ($target.hasClass('action-submit')) {\n\n                    setTimeout(function() {\n\n                        handler(bindingContext.$data, bindingContext.$parent, event, function() {\n                            $submitting.children('span').text(\"Submitting...\");\n                            var offset = $target.offset();\n                            $('.prompt').css('top', offset.top).show();\n\n                        }, function() {\n\n                            $submitting.addClass('disappeared')\n                            $succeed.removeClass('disappeared')\n\n\n                            $('.prompt').delay(1200).fadeOut('slow', function() {\n                                $submitting.removeClass('disappeared')\n                                $succeed.addClass('disappeared')\n\n                            });\n\n\n\n                        });\n\n\n                    }, 100);\n\n\n\n                } else if ($target.hasClass('action-load')) {\n\n                    handler(bindingContext.$data, bindingContext.$parent, event, function() {\n                        $submitting.children('span').text(\"Loading...\");\n                        var offset = $target.offset();\n                        $('.prompt').css('top', offset.top).show();\n\n                    }, function() {\n\n                        $('.prompt').delay(600).fadeOut('slow');\n\n                    });\n\n                } else {\n                    handler(bindingContext.$data, bindingContext.$parent, event);\n\n\n                }\n                return false;\n            });\n\n\n        },\n        update: function(element, valueAccessor, allBindings, viewModel, bindingContext) {\n\n        }\n    }\n\n\n    var ordersModel = new OrdersModel(orders);\n    ko.applyBindings(ordersModel, $('#receivedOrders')[0]);\n\n    var swiper = new Swiper('.swiper-container', {\n        autoHeight: true,\n        spaceBetween: 30,\n        pagination: '.swiper-pagination',\n        paginationClickable: true,\n        simulateTouch: false,\n        shortSwipes: false,\n        longSwipes: false,\n        paginationBulletRender: function(index, className) {\n            var bulletName = '';\n            switch (index) {\n                case 0:\n\n                    bulletName = 'Receiving';\n                    break;\n\n                case 1:\n                    bulletName = 'Purchase';\n                    break;\n\n                case 2:\n                    bulletName = 'Reckoning';\n                    break;\n\n                case 3:\n                    bulletName = 'Income';\n                    break;\n                    /* case 4:\n                         bulletName = 'Delivery';\n                         break;*/\n            }\n            return '<span class=\"' + className + '\">' + bulletName + '</span>';\n        }\n\n    });\n\n    ordersModel.setSwiper(swiper);\n\n    $(window).scroll(function() {\n        var top = $(window).scrollTop();\n        $(\".searchbox\").css(\"top\", top);\n\n    });\n\n\n    require(['ItemsModel', 'ReckoningOrders', 'IncomeList', 'Addresses', 'knockout', 'jquery'], function(ItemsModel, OrdersModel, IncomeListModel, AddressesModel, ko, $) {\n\n        var itemsModel, reckoningOrdersModel, incomeListModel, addressesModel;\n\n        $.getJSON('./purchaseItemsJson', function(rs, status) {\n\n            itemsModel = new ItemsModel(rs.items, rs.markedItems, swiper);\n            ko.applyBindings(itemsModel, $('#purchaseItems')[0]);\n\n        });\n\n\n        $.getJSON('./reckoningOrdersJson', function(orders, status) {\n            reckoningOrdersModel = new OrdersModel(orders, swiper);\n            ko.applyBindings(reckoningOrdersModel, $('#reckoningOrders')[0]);\n\n        });\n\n        $.getJSON('./incomeListJson', function(incomeList, status) {\n            incomeListModel = new IncomeListModel(incomeList, swiper);\n            ko.applyBindings(incomeListModel, $('#incomeList')[0]);\n\n        });\n\n        // $.getJSON('./addressesJson', function(addresses, status) {\n        //     addressesModel = new AddressesModel(addresses, swiper);\n        //     ko.applyBindings(addressesModel, $('#addresses')[0]);\n\n        // });\n\n        $(document).on('keydown', function(event) {\n            if (event.keyCode == 13 && (swiper.activeIndex == 0 || swiper.activeIndex == 2)) {\n                //var $target = $(document.activeElement).closest('.enterArea').find('.action-enter');\n                $(document.activeElement).blur();\n\n                var targetPage = swiper.activeIndex == 0 ? 'receivedOrders' : 'reckoningOrders'\n\n                var $target = $('#' + targetPage + ' .action-enter');\n                setTimeout(function() {\n                    $target.trigger('click')\n                }, 100);\n                return false;\n\n            }\n\n        });\n\n\n        swiper.params.onSlideChangeStart = function(swiper) {\n\n            switch (swiper.activeIndex) {\n                case 0:\n                    $.getJSON('./receivedOrdersJson', function(orders, status) {\n\n                        ordersModel.setOrders(orders);\n                        swiper.update();\n\n                    });\n                    break;\n                case 1:\n                    $.getJSON('./purchaseItemsJson', function(rs, status) {\n                        itemsModel.setItems(rs.items, rs.markedItems);\n                        swiper.update();\n\n                    });\n                    break;\n\n                case 2:\n                    $.getJSON('./reckoningOrdersJson', function(orders, status) {\n\n                        var observableOrders = reckoningOrdersModel.getObservableOrders(orders);\n                        reckoningOrdersModel.orders(observableOrders);\n                        swiper.update();\n\n                    })\n                    break;\n                case 3:\n                    $.getJSON('./incomeListJson', function(incomeList, status) {\n                        incomeListModel.setIncomeList(incomeList);\n                        swiper.update();\n\n                    })\n                    break;\n                case 4:\n                    $.getJSON('./addressesJson', function(addresses, status) {\n                        addressesModel.setAddresses(addresses);\n                        swiper.update();\n\n                    })\n                    break;\n            }\n            $(window).scrollTop(0);\n\n\n        }\n\n\n    });\n\n\n});\n"]}