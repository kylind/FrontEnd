"use strict";var _slicedToArray=function(){function t(t,e){var n=[],r=!0,a=!1,i=void 0;try{for(var u,s=t[Symbol.iterator]();!(r=(u=s.next()).done)&&(n.push(u.value),!e||n.length!==e);r=!0);}catch(t){a=!0,i=t}finally{try{!r&&s.return&&s.return()}finally{if(a)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();define(["jquery","knockout","knockout.mapping"],function(t,e,n){e.mapping=n;var r=function(t){var n=this;n._id=e.observable(t?t._id:""),n.quantity=e.observable(t?t.quantity:""),n.purchaseDetail=e.observableArray(t?t.purchaseDetail:[]),n.subItems=e.observableArray([]),n.hasItemDetail=function(t){return n.subItems().length>0},n.displaySubItems=e.computed(function(){return n.subItems().length>0}),n.markDone=function(){},n.markItemStatus=function(){var t=n.purchaseDetail(),e=0,r=0;return t.forEach(function(t){t.isDone?e=t.quantity:r=t.quantity}),r==n.quantity()?"":0==r?"font-green":"font-yellow"},n.markSubItemStatus=function(t){return t.isDone?"font-red":""},n.isSubItemsOpen=!1},a=function(t){var e=this;e.name=t?t.name:"",e.note=t?t.note:"",e.quantity=t?t.quantity:""},i=function(n,i,u){function s(t,e){var n=[];Array.isArray(t)&&t.length>0&&t.forEach(function(t){n.push(new r(t))});var i=[];return Array.isArray(e)&&e.length>0&&e.forEach(function(t){i.push(new a(t))}),[n,i]}var n=s(n,i),o=n[0],c=n[1],m=this;m.itemview=e.observable("name"),m.items=e.observableArray(o),m.markedItems=e.observableArray(c),m.setItems=function(t,e){var n=s(t,e),r=_slicedToArray(n,2),t=r[0],e=r[1];m.items(t),m.markedItems(e)},m.getSubName=function(t){return"item"+t.isDone},m.getSubItems=function(n,r,a){var i=e.mapping.toJS(n);if(n.isSubItemsOpen)t(a.target).parents(".orderitem-cnt").next().slideUp("fast",function(){n.isSubItemsOpen=!1,u.update()});else{arguments[3]();var s=arguments[4];t.getJSON("./subitems",{itemName:i._id},function(e,r){"success"==r?n.subItems(e):n.subItems([]),t(a.target).parents(".orderitem-cnt").next().slideDown("fast",function(){n.isSubItemsOpen=!0,s()})})}},m.markDone=function(n){arguments[3]();var r=arguments[4],a=e.mapping.toJS(n),i=!0;a.purchaseDetail.forEach(function(t){t.isDone||(i=!1)}),t.post("./item",{itemName:a._id,isDone:!i},function(t,e){n.purchaseDetail(t.purchaseDetail),r()},"json")}};return i});
//# sourceMappingURL=purchase-items.js.map
