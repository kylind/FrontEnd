{"version":3,"sources":["public/js/settings/settings.module.js","public/js/settings/settings.component.js"],"names":["define","angular","module","userId","USER_ID","constant","directive","link","scope","iElement","iAttrs","controller","floatRegex","passwordRegex","type","targetId","targetType","isLegal","$watch","value","oldValue","test","comparingValue","onValidate","targetName","targetValue","$scope","$element","$attrs","$transclude","transclude","templateUrl","service","$resource","this","findUser","id","User","user","get","_id","$promise","component","userService","self","passwordConfirmation","myClasses","verifiedRS","validate","name","then","password","saveUser","isReady","prop","$save","rs","setTimeout","$apply"],"mappings":"AAAA,YCCAA,SAAQ,UAAU,YAAY,cAAe,SAASC,SAElDA,QAAQC,OAAO,YAAa,aAAa,aAEzC,IAAIC,QAASC,SAAW,EAExBH,SAAQC,OAAO,YAAYG,SAAS,UAAWF,QAE/CF,QAAQC,OAAO,YAAYI,UAAU,eAAgB,WAEjD,OAEIC,KAAM,SAASC,MAAOC,SAAUC,OAAQC,YACpC,GAAIC,YAAa,cACbC,cAAgB,iCAGhBC,MADSJ,OAAOK,SACTL,OAAOM,WAElBR,OAAMS,SAAU,EAEhBT,MAAMU,OAAO,cAAe,SAASC,MAAOC,UAExC,OAAQN,MAEJ,IAAK,QACDN,MAAMS,QAAUL,WAAWS,KAAKF,MAChC,MACJ,KAAK,WACDX,MAAMS,QAAmB,IAATE,OAAqBN,cAAcQ,KAAKF,MACxD,MACJ,KAAK,mBACDX,MAAMS,QAAmB,IAATE,OAAqBA,OAASX,MAAMc,eAK5Dd,MAAMe,YAAaC,WAAYhB,MAAMgB,WAAYC,YAAajB,MAAMiB,YAAaR,QAAST,MAAMS,aAOxGN,WAAY,SAASe,OAAQC,SAAUC,OAAQC,eAI/CrB,OACIgB,WAAY,IACZR,WAAY,IACZS,YAAa,IACbH,eAAgB,KAChBC,WAAY,KAEhBO,YAAY,EACZC,YAAa,4CAIrB9B,QAAQC,OAAO,YAAY8B,QAAQ,cAAe,SAASC,WACvDC,KAAKC,SAAW,SAASC,IACrB,GAAIC,MAAOJ,UAAU,eACjBK,KAAOD,KAAKE,KAAMC,IAAKJ,IAC3B,OAAOE,MAAKG,YAMpBxC,QAAQC,OAAO,YAAYwC,UAAU,YACjCX,YAAa,uCACbpB,YAAa,SAAU,cAAe,UAAW,SAASe,OAAQiB,YAAaP,IAC3E,GAAIQ,MAAOV,IAGXU,MAAKC,qBAAuB,GAE5BD,KAAKE,UAAY,EAEjB,IAAIC,cACJH,MAAKI,SAAW,SAASC,KAAM9B,MAAOF,SAElC8B,WAAWE,MAAQhC,SAIvB0B,YAAYR,SAASC,IAAIc,KAAK,SAASZ,MACnCM,KAAKN,KAAOA,KACZM,KAAKN,KAAKa,SAAW,KAIzBP,KAAKQ,SAAW,WAEZ,GAAIC,UAAU,CAEd,KAAK,GAAIC,QAAQP,YACb,IAAKA,WAAWO,MAAO,CACnBD,SAAU,CACV,OAuBR,MAnBIA,WAEAT,KAAKE,UAAY,WAEjBF,KAAKN,KAAKiB,QAAQL,KAAK,SAASM,IAE5BZ,KAAKE,UAAY,YAEjBW,WAAW,WACP/B,OAAOgC,OAAO,WACVd,KAAKE,UAAY,MAGtB,SAMJ","file":"settings.min.js","sourcesContent":["\n\n\n\n","\ndefine(['angular','ngAnimate','ngResource'], function(angular) {\n\n    angular.module('settings', ['ngResource','ngAnimate']);\n\n    var userId = USER_ID || '';\n\n    angular.module('settings').constant('USER_ID', userId );\n\n    angular.module('settings').directive('myValidation', function() {\n\n        return {\n\n            link: function(scope, iElement, iAttrs, controller) {\n                var floatRegex = /^\\d?\\.?\\d+$/;\n                var passwordRegex = /^(?!([a-zA-Z]+|\\d+)$)[\\S]{8,}$/;\n\n                var target = iAttrs.targetId;\n                var type = iAttrs.targetType;\n\n                scope.isLegal = true;\n\n                scope.$watch('targetValue', function(value, oldValue) {\n\n                    switch (type) {\n\n                        case 'float':\n                            scope.isLegal = floatRegex.test(value);\n                            break;\n                        case 'password':\n                            scope.isLegal = value == '' ? true : passwordRegex.test(value);\n                            break;\n                        case 'password-confirm':\n                            scope.isLegal = value == '' ? true : value == scope.comparingValue;\n                            break;\n\n                    }\n\n                    scope.onValidate({ targetName: scope.targetName, targetValue: scope.targetValue, isLegal: scope.isLegal })\n\n\n                });\n\n            },\n\n            controller: function($scope, $element, $attrs, $transclude) {\n\n\n            },\n            scope: {\n                targetName: '@',\n                targetType: '@',\n                targetValue: '@',\n                comparingValue: '@?',\n                onValidate: '&'\n            },\n            transclude: true,\n            templateUrl: \"./js/settings/validation.template.html\"\n        }\n    });\n\n    angular.module('settings').service('userService', function($resource) {\n        this.findUser = function(id) {\n            var User = $resource('./user/:_id');\n            var user = User.get({ _id: id });\n            return user.$promise;\n        }\n\n    });\n\n\n    angular.module('settings').component('settings', {\n        templateUrl: './js/settings/settings.template.html',\n        controller: ['$scope', 'userService', 'USER_ID', function($scope, userService, id) {\n            var self = this;\n\n\n            self.passwordConfirmation = '';\n\n            self.myClasses = '';\n\n            var verifiedRS = {};\n            self.validate = function(name, value, isLegal) {\n\n                verifiedRS[name] = isLegal;\n\n            };\n\n            userService.findUser(id).then(function(user) {\n                self.user = user;\n                self.user.password = '';\n            });\n\n\n            self.saveUser = function() {\n\n                var isReady = true;\n\n                for (let prop in verifiedRS) {\n                    if (!verifiedRS[prop]) {\n                        isReady = false;\n                        break;\n                    }\n                }\n\n                if (isReady) {\n\n                    self.myClasses = 'isActive';\n\n                    self.user.$save().then(function(rs) {\n\n                        self.myClasses = 'isSuccess';\n\n                        setTimeout(function() {\n                            $scope.$apply(function() {\n                                self.myClasses = '';\n                            });\n\n                        }, 900)\n\n                    });\n\n                }\n\n                return false;\n            }\n\n        }]\n    });\n\n});\n"]}